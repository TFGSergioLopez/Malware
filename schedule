# Obtiene el nombre de usuario actual junto con el dominio
$currentUser = [System.Security.Principal.WindowsIdentity]::GetCurrent().Name

# Configura la acción que ejecutará la tarea programada
$Action = New-ScheduledTaskAction -Execute "Ruta\de\tu\aplicación.exe"

# Crea un trigger para la tarea que se activará al iniciar sesión
$Trigger = New-ScheduledTaskTrigger -AtStartup

# Configura la tarea para ejecutarse con el usuario actual
$Principal = New-ScheduledTaskPrincipal -UserId $currentUser -LogonType Interactive

# Configura la tarea para que se ejecute oculta
$Settings = New-ScheduledTaskSettingsSet -Hidden

# Crea la tarea con los parámetros configurados
$Task = New-ScheduledTask -Action $Action -Principal $Principal -Trigger $Trigger -Settings $Settings

# Registra la tarea programada con el nombre proporcionado
Register-ScheduledTask "NombreDeLaTarea" -InputObject $Task
